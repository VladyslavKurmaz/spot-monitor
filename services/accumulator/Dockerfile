FROM openjdk:8u151-jre-alpine

ARG SERVICES_ACCUMULATOR_ARTIFACT
ARG SERVICES_ACCUMULATOR_HOST
ARG SERVICES_ACCUMULATOR_PORT

ENV SERVICES_ACCUMULATOR_ARTIFACT $SERVICES_ACCUMULATOR_ARTIFACT
ENV SERVICES_ACCUMULATOR_HOST $SERVICES_ACCUMULATOR_HOST
ENV SERVICES_ACCUMULATOR_PORT $SERVICES_ACCUMULATOR_PORT

RUN apk --update --no-cache add curl

COPY ./target/${SERVICES_ACCUMULATOR_ARTIFACT} /
HEALTHCHECK --interval=5s --timeout=3s CMD curl --fail http://localhost:${SERVICES_ACCUMULATOR_PORT}/healthcheck || exit 1

CMD exec java -jar /${SERVICES_ACCUMULATOR_ARTIFACT}
